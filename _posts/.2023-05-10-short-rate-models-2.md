<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>
---
layout: post
title: "Short Rate Models"
date: 2023-05-10
tags: [study-notes, quantitative-finance]
---

# Refresher on Short Rate Models

## Table of Contents

1. [Introduction](#introduction)
2. [Zero-Coupon Bond Prices and Yields](#zero-coupon-bond-prices-and-yields)
3. [Ho-Lee Model](#ho-lee-model)
4. [Vasicek Model](#vasicek-model)
5. [Cox-Ingersoll-Ross (CIR) Model](#cox-ingersoll-ross-cir-model)
6. [Hull-White Model](#hull-white-model)
7. [G2++ Model](#g2-model)
8. [Dynamic Affine Term Structure Models](#dynamic-affine-term-structure-models)

## Introduction
Welcome to my refresher notes on a type of interest rate term structure models called the **short-rate model**. It is disguised as a step-by-step guide and is written to help you (and me) understand, formulate, and solve this type of models by deriving and implementing well-known models of varying complexity and generality.

In a short-rate model, we focus on the modeling of the evolution of the instantaneous spot rate, also known as the short rate, at which the market lends to a borrower for an infinitesimal period of time. In a short-rate model, the short rate is assumed to evolve over time according to a stochastic process that captures the observed or theorized behavior. As the short rate evolve into the future, by the no-arbitrage principle, all rates at which the market lends to a borrower over longer periods of time can be determined by the parameters of the models. These parameters are unknown in practice, so much either be calibrated from the market observed yield curve or estimated from historical data. 

For each model, I first describe the process that drives the short rate. I then provide a step-by-step guide to derive the price of a zero-coupon bond, where some steps are left as exercise. It is then followed by a guide to Python implementations of the pricing of the zero coupon bond, the simulation of the process, and an construction of a lattice that is sometimes used to price other derivatives.

## Preliminaries: Zero-Coupon Bond Prices and Yields

Zero-coupon bonds form the foundation of term structure modeling. For a zero-coupon bond maturing at time $$T$$, the relationship between its price $$P(t, T)$$ and yield-to-maturity $$y(t, T)$$ at time $$t$$ is given by

- Yiel to Price: 

$$P\left(t, T\right) = \exp\left(-y_t^T \left(T-t\right)\right)$$ 

- Price to Yield: 

$$y\left(t, T\right) = -\frac{\ln\left(P_t^T\right)}{T-t}$$

However, in a short rate model, we explicitly specify the dynamic of the short rate $$r_t$$ and not the yield-to-maturity of the individual zero coupond bonds. In order to price a zero-coupon bond using a short-rate model, we need to take the average of the short rates along the path from the present day to the maturity of the bond (under the risk-neutral measure.)

- Short Rate to Price: 

$$P\left(t, T\right) = \mathbb{E}_t^Q\left[\exp\left(-\int_t^T r_s ds\right)\right]$$

- Short Rate to Yield: 

$$y\left(t, T\right) = \mathbb{E}_t^Q\left[\frac{\int_t^T r_s ds}{T-t}\right]$$

These fundamental relationships provide the basis for more complex term structure models.

## Merton's Model (1973)

The Merton's model is one of the first short rate models and is arguably the simplest one. It was introduced by the renowned economist Robert C. Merton in 1973. It extends the concepts of equity option pricing to the bond market by modeling the dynamics of short-term interest rates in a continuous-time framework. The model uses a simple Gaussian process for the short rate, assuming that it follows a Brownian motion with drift. It laid the foundation for many subsequent term structure models and produced a linear relationship between bond yields and maturity, a feature that, while simplistic, provided crucial insights into interest rate dynamics generated by the short rate models. 

### Model Specification

Merton's model is defined by the following stochastic differential equation:

$$dr_t = \mu dt + \sigma dW_t$$

Where:
- $$r_t$$: short-term interest rate at time $$t$$
- $$\mu$$: constant drift term
- $$\sigma$$: constant volatility
- $$W_t$$: Wiener process (standard Brownian motion)

### Key Concepts

#### Continuous-Time Modeling
Merton's model was one of the first to apply continuous-time stochastic processes to interest rate modeling, paving the way for more sophisticated models.

#### Gaussian Process
The model assumes that interest rates follow a Gaussian process, allowing for both positive and negative rates.

### Bond Pricing in Merton's Model

The price of a zero-coupon bond in Merton's model is given by:

$$P(t,T) = \exp\left(-(T-t)r_t - \frac{1}{2}(T-t)^2(\mu + \frac{\sigma^2}{2}) + \frac{1}{6}(T-t)^3\sigma^2\right)$$

### Derivation of the Bond Price Formula

We will derive the formula for the zero-coupon bond prices two different ways. The first way is to solve stochastic integral directly, and the second way is to "guess" the form of the solution and solve it by matching the bond price formula to the guessed solution.

#### Direct Solution
1. Start with the general bond pricing equation:
   $$P(t,T) = \mathbb{E}_t^Q\left[\exp\left(-\int_t^T r_s ds\right)\right]$$
   where $$\mathbb{E}_t^Q$$ denotes the expectation under the risk-neutral measure.

2. In Merton's model, $$r_t$$ follows a Gaussian process, so $$\int_t^T r_s ds$$ is normally distributed.

3. For a normally distributed variable $$X$$ with mean $$m$$ and variance $$v$$, we have:
   $$\mathbb{E}\left[\exp\left(-X\right)\right] = \exp\left(-m + \frac{1}{2}v\right)$$

4. Calculate the mean and variance of $$\int_t^T r_s ds$$, note that $$r_s = \int_t^T r_t ds + \int_t^T \mu\left(s-t\right)ds + \sigma\int_t^T \int_t^s dW_u ds $$ which $$=r_t\left(s-t\right) + \mu\frac{\left(s-t\right)^2}{2} + \sigma\int_t^T dW_s$$:
   
   Mean: $$m = \mathbb{E}_t^Q\left[\int_t^T r_s ds\right] = (T-t)r_t + \frac{1}{2}(T-t)^2\mu$$
   
   Variance: $$v = \text{Var}_t^Q\left[\int_t^T r_s ds\right] = \text{E}_t^Q\left[\int_t^T r_s^2 ds\right] =\frac{1}{3}(T-t)^3\sigma^2$$

5. Apply the formula from step 3:
   $$P(t,T) = \exp\left(-(T-t)r_t - \frac{1}{2}(T-t)^2\mu + \frac{1}{6}(T-t)^3\sigma^2\right)$$

6. Adjust for risk-neutral pricing by replacing $\mu$ with $\mu + \frac{\sigma^2}{2}$:
   $$P(t,T) = \exp\left(-(T-t)r_t - \frac{1}{2}(T-t)^2(\mu + \frac{\sigma^2}{2}) + \frac{1}{6}(T-t)^3\sigma^2\right)$$


This is the closed-form solution for bond prices in Merton's model.

### Implementation Guide: Simulating Merton's Model

1. Import necessary libraries
2. Define model parameters: $$r_0$$, $$\mu$$, $$\sigma$$
3. Set up time grid: $$t = [0, \Delta t, 2\Delta t, ..., T]$$
4. Implement Euler-Maruyama method for simulation:

```python
import numpy as np

def merton_simulate(r0, mu, sigma, T, N):
    dt = T / N
    t = np.linspace(0, T, N+1)
    r = np.zeros(N+1)
    r[0] = r0
    
    for i in range(1, N+1):
        dr = mu * dt + sigma * np.sqrt(dt) * np.random.normal()
        r[i] = r[i-1] + dr
    
    return t, r
```

## Vasicek Model

The Vasicek model, introduced by Oldrich Vasicek in 1977, is one of the earliest and most influential term structure models. It assumes that the short-term interest rate follows a mean-reverting Ornstein-Uhlenbeck process.

### Model Specification

The Vasicek model is defined by the following stochastic differential equation:

$$dr_t = \kappa(\theta - r_t)dt + \sigma dW_t$$

Where:
- $$r_t$$: short-term interest rate at time $$t$$
- $$\kappa$$: speed of mean reversion
- $$\theta$$: long-term mean level
- $$\sigma$$: volatility
- $$W_t$$: Wiener process (standard Brownian motion)

### Key Concepts

#### Mean Reversion
Mean reversion is the tendency of a process to "pull back" towards its long-term average. In the context of interest rates, this reflects the economic intuition that rates tend to fluctuate around a long-term equilibrium level.

### Bond Pricing in the Vasicek Model

One of the advantages of the Vasicek model is that it allows for closed-form solutions for bond prices. The price of a zero-coupon bond is given by:

$$P(t,T) = A(t,T)e^{-B(t,T)r_t}$$

where $A(t,T)$ and $B(t,T)$ are functions of the model parameters.

#### Derivation of A(t,T) and B(t,T)

1. We start with the assumption that the bond price has the form:
   $$P(t,T) = e^{C(t,T) - D(t,T)r_t}$$
   where we need to determine $C(t,T)$ and $D(t,T)$.

2. Apply It√¥'s lemma to this bond price formula.

3. Under the risk-neutral measure, the drift of the bond price should equal the short rate $r_t$.

4. Equating the coefficients of $r_t$ and the constant terms, we get:
   $$\frac{\partial D}{\partial t} - D\kappa + 1 = 0$$
   $$\frac{\partial C}{\partial t} + D\kappa\theta + \frac{1}{2}D^2\sigma^2 = 0$$

5. Solve the first ODE for $D(t,T)$ with the boundary condition $D(T,T) = 0$:
   $$D(t,T) = B(t,T) = \frac{1 - e^{-\kappa(T-t)}}{\kappa}$$

6. Substitute this into the second ODE and solve for $C(t,T)$ with $C(T,T) = 0$:
   $$C(t,T) = (\theta - \frac{\sigma^2}{2\kappa^2})(B(t,T) - (T-t)) - \frac{\sigma^2}{4\kappa}B(t,T)^2$$

7. Finally, we can express $A(t,T)$ as:
   $$A(t,T) = e^{C(t,T)} = \exp\left((\theta - \frac{\sigma^2}{2\kappa^2})(B(t,T) - (T-t)) - \frac{\sigma^2}{4\kappa}B(t,T)^2\right)$$

### Implementation Guide: Simulating the Vasicek Model

1. Import necessary libraries (numpy for numerical computations)
2. Define model parameters: $r_0$, $\kappa$, $\theta$, $\sigma$
3. Set up time grid: $t = [0, \Delta t, 2\Delta t, ..., T]$
4. Initialize array for interest rates: $r = [r_0, 0, 0, ..., 0]$
5. Implement Euler-Maruyama method for simulation:

```python
import numpy as np

def vasicek_simulate(r0, kappa, theta, sigma, T, N):
    dt = T / N
    t = np.linspace(0, T, N+1)
    r = np.zeros(N+1)
    r[0] = r0
    
    for i in range(1, N+1):
        dr = kappa * (theta - r[i-1]) * dt + sigma * np.sqrt(dt) * np.random.normal()
        r[i] = r[i-1] + dr
    
    return t, r
```

## Cox-Ingersoll-Ross (CIR) Model

The CIR model addresses some limitations of the Vasicek model, particularly the possibility of negative interest rates.

### Model Specification:

$$dr_t = \kappa(\theta - r_t)dt + \sigma\sqrt{r_t}dW_t$$

The square root term ensures that interest rates remain non-negative, providing a more realistic model in many scenarios.

## Hull-White Model

The Hull-White model extends the Vasicek model by introducing time-dependent parameters, allowing for a better fit to the initial term structure.

### Model Specification:

$$dr_t = [\theta(t) - \alpha(t)r_t]dt + \sigma(t) dW_t$$

This flexibility makes the Hull-White model particularly useful for pricing interest rate derivatives.

## G2++ Model

The G2++ model, a two-factor extension of the Hull-White model, provides even greater flexibility in modeling complex yield curve dynamics.

### Model Specification:

$$dx_t = -ax_t dt + \sigma dW_t^1$$
$$dy_t = -by_t dt + \eta dW_t^2$$
$$r_t = x_t + y_t + \phi(t)$$

Where $W_t^1$ and $W_t^2$ are correlated Wiener processes.

## Dynamic Affine Term Structure Models

Dynamic Affine Term Structure Models (DATSMs) provide a general framework encompassing many of the specific models we've discussed.

### General Form:

$$dX_t = K(\theta - X_t)dt + \Sigma\sqrt{S_t}dW_t$$
$$r_t = \delta_0 + \delta_1' X_t$$

This framework allows for a rich set of term structure behaviors while maintaining analytical tractability.

---

Understanding these models provides a solid foundation for analyzing interest rate dynamics, pricing fixed income securities, and managing interest rate risk. As we progress through each model, we'll delve deeper into their mathematical properties, economic implications, and practical applications in financial markets.